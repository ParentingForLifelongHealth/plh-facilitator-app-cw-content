{
  "flow_type": "template",
  "flow_name": "message_element",
  "status": "released",
  "rows": [
    {
      "name": "title",
      "exclude_from_translation": true,
      "comments": "need to sort disclaimer"
    },
    {
      "name": "has_disclaimer",
      "value": false,
      "exclude_from_translation": true
    },
    {
      "name": "message_text",
      "exclude_from_translation": true
    },
    {
      "name": "message_guidance",
      "exclude_from_translation": true
    },
    {
      "name": "asset",
      "exclude_from_translation": true
    },
    {
      "name": "asset_type",
      "exclude_from_translation": true
    },
    {
      "name": "log_time",
      "value": true,
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "name": "dg_box",
      "style_list": "background-color: var(--ion-color-gray-100);\npadding: 12px;",
      "parameter_list": "style: column;",
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "message_title",
      "value": "@local.title",
      "parameter_list": "style: emphasised",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "parameter_list": "style: column;\nvariant: box_white;",
      "exclude_from_translation": true
    },
    {
      "name": "media_asset",
      "value": "initial"
    },
    {
      "name": "media_type",
      "value": "initial"
    },
    {
      "name": "media_asset_cw",
      "value": "initial"
    },
    {
      "type": "data_items",
      "value": "media_data",
      "action_list": "data_changed | set_local : asset: @items[0].media_asset_cw;\ndata_changed | set_local : asset_type: @items[0].type;",
      "condition": "(@fields._app_language == \"cw_pap\") && (@local.asset_type == \"media\")",
      "parameter_list": "filter: @item.id == @local.asset;\nlimit: 1;"
    },
    {
      "type": "data_items",
      "value": "media_data",
      "action_list": "data_changed | set_local : asset: @items[0].media_asset;\ndata_changed | set_local : asset_type: @items[0].type;",
      "condition": "(@fields._app_language !== \"cw_pap\") && (@local.asset_type == \"media\")",
      "parameter_list": "filter: @item.id == @local.asset;\nlimit: 1;"
    },
    {
      "type": "begin_display_group",
      "condition": false,
      "parameter_list": "style: column",
      "exclude_from_translation": true,
      "comments": "@local.asset_type == \"media\""
    },
    {
      "type": "begin_data_items",
      "value": "media_data",
      "parameter_list": "filter: @item.id == @local.asset;\nlimit: 1;"
    },
    {
      "type": "video",
      "name": "message_video",
      "value": "@item.media_asset",
      "condition": "@item.type == \"video\"",
      "exclude_from_translation": true
    },
    {
      "type": "audio",
      "name": "message_audio",
      "value": "@item.media_asset",
      "condition": "@item.type == \"audio\"",
      "exclude_from_translation": true
    },
    {
      "type": "youtube",
      "name": "message_youtube",
      "value": "@item.media_asset_cw",
      "condition": "(@fields._app_language == \"cw_pap\") && (@item.type == \"youtube\")",
      "exclude_from_translation": true
    },
    {
      "type": "youtube",
      "name": "message_youtube_cw",
      "value": "@item.media_asset",
      "condition": "(@fields._app_language !== \"cw_pap\") && (@item.type == \"youtube\")",
      "exclude_from_translation": true
    },
    {
      "type": "end_data_items"
    },
    {
      "type": "data_items",
      "value": "media",
      "action_list": "data_changed | set_local : media_asset: @items[0].media_asset;",
      "condition": false,
      "comments": "?!?!"
    },
    {
      "type": "data_items",
      "value": "@data.media",
      "action_list": "data_changed | set_local : media_type: @items[0].type;",
      "condition": false
    },
    {
      "type": "data_items",
      "value": "media_data",
      "action_list": "data_changed | set_local : media_asset_cw: @items[0].media_asset_cw;\n\n",
      "condition": false,
      "comments": "(@fields.app.language == \"cw_pap\") && (@local.media_type == \"youtube\")"
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "image",
      "name": "message_image",
      "value": "@local.asset",
      "condition": "@local.asset_type == \"image\"",
      "exclude_from_translation": true
    },
    {
      "type": "youtube",
      "name": "message_youtube",
      "value": "@local.asset",
      "condition": "@local.asset_type == \"youtube\"",
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "message_text",
      "value": "@local.message_text",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "name": "dg_bottom",
      "parameter_list": "style: column;\n"
    },
    {
      "type": "text",
      "name": "message_guidance",
      "value": "@local.message_guidance",
      "parameter_list": "flex: 1;\nstyle: contextual;",
      "comments": "needs to be bullet point"
    },
    {
      "name": "share_message",
      "value": "@local.message_text"
    },
    {
      "name": "share_message",
      "value": "@local.message_text @local.asset",
      "condition": "(!!@local.message_text) && (@local.asset_type == \"youtube\")"
    },
    {
      "name": "share_message",
      "value": "@local.asset",
      "condition": "(!@local.message_text) && (@local.asset_type == \"youtube\")"
    },
    {
      "type": "begin_display_group",
      "name": "log_buttons",
      "condition": "@local.log_time"
    },
    {
      "type": "text",
      "name": "spacer",
      "value": " ",
      "style_list": "flex: 1;"
    },
    {
      "type": "round_button",
      "name": "copy",
      "action_list": "click | add_data | \n_list_id: message_log,\ngroup_id: @fields.current_group_no,\nmodule: @fields.current_module_no,\nmessage: @local.title,\ndate: @calc(now());\nclick | copy | text:@local.share_message, message: @global.copied_message\n",
      "condition": "@local.asset_type !== \"image\"",
      "parameter_list": "icon_src: images/icons/copy-outline.svg;"
    },
    {
      "type": "round_button",
      "name": "button",
      "value": "Share",
      "action_list": "click | add_data | \n_list_id: message_log,\ngroup_id: @fields.current_group_no,\nmodule: @fields.current_module_no,\nmessage: @local.title,\ndate: @calc(now());\nclick | share | text: @local.share_message;\n",
      "condition": false,
      "parameter_list": "icon_src: images/icons/share.svg;",
      "comments": "icon: images/icons/share.svg;\nicon_position: right;"
    },
    {
      "type": "round_button",
      "name": "button",
      "value": "Share",
      "action_list": "click | add_data | \n_list_id: message_log,\ngroup_id: @fields.current_group_no,\nmodule: @fields.current_module_no,\nmessage: @local.title,\ndate: @calc(now());\nclick | share |\ntext: @local.message_text,\nfile: @local.asset;",
      "condition": "@local.asset_type !== \"youtube\"",
      "parameter_list": "icon_src: images/icons/share.svg;",
      "comments": "icon: images/icons/share.svg;\nicon_position: right;"
    },
    {
      "type": "round_button",
      "name": "button",
      "value": "Share",
      "action_list": "click | add_data | \n_list_id: message_log,\ngroup_id: @fields.current_group_no,\nmodule: @fields.current_module_no,\nmessage: @local.title,\ndate: @calc(now());\nclick | share |\ntext: @local.share_message;",
      "condition": "@local.asset_type == \"youtube\"",
      "parameter_list": "icon_src: images/icons/share.svg;"
    },
    {
      "type": "end_display_group"
    },
    {
      "type": "begin_display_group",
      "name": "no_log_buttons",
      "condition": "!@local.log_time"
    },
    {
      "type": "text",
      "name": "spacer",
      "value": " ",
      "style_list": "flex: 1;"
    },
    {
      "type": "round_button",
      "name": "copy",
      "action_list": "click | copy | text:@local.share_message",
      "parameter_list": "icon_src: images/icons/copy-outline.svg;"
    },
    {
      "type": "round_button",
      "name": "button",
      "value": "Share",
      "action_list": "click | share | text: @local.share_message\n",
      "condition": "@local.asset_type !== \"image\"",
      "parameter_list": "icon_src: images/icons/share.svg;"
    },
    {
      "type": "round_button",
      "name": "button",
      "value": "Share",
      "action_list": "click | share |\ntext: @local.message_text,\nfile: @local.asset",
      "condition": "@local.asset_type == \"image\"",
      "parameter_list": "icon_src: images/icons/share.svg;"
    },
    {
      "type": "end_display_group"
    },
    {
      "type": "end_display_group"
    },
    {
      "type": "end_display_group"
    }
  ]
}